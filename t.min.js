/*t.js-0.1;(c)2014 Mntn(r) <http://mn.tn/> c/o Benjamin Lips <g--AT--mn.tn>;Licensed under the MIT License <http://mit-license.org/>;For documentation see http://github.com/mntn-dev/t.js or http://mn.tn/dev/t.js*/(function(d){d.fn.t=function(t,u){return this.each(function(){var a=u,e=t,b=d(this),m="12qwertyuiop[]asdfghjkl;zxcvbnm,./~!@#$%^&*()_+:1234567890-=op".split([]),f=function(a,b){return d.type(a)[0]==(b||"n")},n=function(){g=d.grep(h,function(a){return"&"==a[0]||!a[1]}).length-1;return-1<g?g:0};""===e&&(e="<del>*</del>");if(b.data("is_typing"))return"pause"==e&&b.data("pause",a?a:b.data("pause")?0:1),this;if("pause"!=e){b.data("is_typing",1);f(e,"o")&&(a=e);if(/t\-/.test(b.attr("class")))return this;
if("add"==e&&d(".t-container",b)[0])var l=a,a=d.extend(b.data()),k=b=d(":first",b),l="<"+a.tag+' class="typing-add">'+l+"</"+a.tag+">";else{"add"==e&&(e=a,a={});var a=d.extend({t:!0,delay:!1,speed:75,speed_vary:!1,caret:"\u258e",tag:"span",blink:!1,repeat:-3,wrap:!1,mistype:!1,locale:"en",init:d.noop,typing:d.noop,fin:d.noop},a),p=!1,l=!1,c,h,q,r,s;d(".t-container",b)[0]||(b.wrapInner(d("<"+a.tag+"/>",{"class":"t-container",style:"top:auto;bottom:auto;"})),b.css("position").match(/^[ar]/)||b.css({position:"relative"}),
b.css({overflow:"hidden"}));a.wrap&&!b.parent().data("t-wrap")&&(b.wrap(d("<div/>",a.wrap[0].match(/[.#]/)?"#"==a.wrap[0]?{id:a.wrap.substr(1)}:{"class":a.wrap.substr(1)}:{style:a.wrap})),b.parent().data("t-wrap",1));f(a.caret,"s")&&!d(".t-caret",b)[0]&&(f(a.blink)&&10>a.blink&&(a.blink=10),p=d("<"+a.tag+"/>",{"class":"t-caret",html:a.caret}).appendTo(b),a.blink&&b.append("\u200b")&&(r=setInterval(function(){p.toggle()},f(a.blink)?a.blink:a.speed*(a.speed_vary?4:5))));a.blink||clearInterval(r);a.speed=
!f(a.speed)||10>a.speed?10:a.speed;a.speed_vary&&(a.speed/=2.5);1<a.mistype||(a.mistype=!1);b.data(a);d(".typing-0",b).replaceWith(function(){return this.childNodes});d(".typing-add",b).remove();k=b=d(":first",b);h=f(e,"s")?e:b.html();b.empty();k.parent().show().css({visibility:"visible"});f(a.delay)&&0<a.delay&&(c=~~(1E3*a.delay/a.speed))}h=String(l||h).replace(/(.*?)[\r\n\u200b]+$/,"$1").replace(/<\!\-\-([\s\S]+)\-\->/g,"$1").replace(/<(img|br|input|hr)(.*?)[\/]?>/g,"<#$1$2/>").replace(/<ins>(\d+[.]?\d{0,})</g,
'<#ins data-ins="$1"><#/ins><#').replace(/(<del data-del=")([\s\S]+?)(".*?)></g,"$1$2$3>$2<").replace(/<del>([\s\S]*?)(?:\x20*<.*?( data-ins="(.*?)").*?(<#\/ins>)+)?</g,function(a,b,c,d){return'<del data-del="'+b.replace(/\n/,"\\n")+'" data-ins="'+("*"!=b?d?d:".35":".25")+'">'+("*"!=b?b:"")+"<"}).replace(/(?!<ins)<(\w+)(.*?)>/g,"<$1$2></$1>").replace(/(<ins>)([\s\S]+?)(<\/ins>)/g,function(a,b,c,d){return b+c.replace(/<(.*?)><\/.*?>/g,"<$1>")+d}).replace(/<#/g,"<").match(/<ins>[\s\S]+?<\/ins>|<\/.*?>|<[\s\S]+?<?\/.*?>|<[\s\S]+?>|&[#]?[a-z0-9]+;|\r|\n|./ig);
!f(c)&&(c=h.shift());h.push("\u200b");"de"==a.locale&&(m='12qwertzuiop\u00fc+asdfghjkl\u00f6\u00e4#<yxcvbnm,.-!"\u00a7$%&/(()=?1234567890\u00df*p+');q=n();!l&&a.init(k.parent());s=setInterval(function(){if(!k.parent().data("pause")){if(f(c)){if(--c)return;c=b.data().ins?"//":h.shift()}else if(a.speed_vary&&~~(4*Math.random()))return;if(b.data().del&&(o=String(b.data().del),!f(c,"a")&&"/"==c[1]&&(c=o.replace(/\\n/g,"\n").split([])),f(c,"a"))){if(c.pop()){b.text(c.join([]));return}"*"==o&&(k.wrapInner(d("<"+
a.tag+"/>",{"class":"typing-0",style:"display:none;"})),b=b.parent(),l&&(h=d.merge(["<"+a.tag+' class="typing-add"></'+a.tag+">"],h,["</"+a.tag+">"]),b=b.parent()));b=b.parent();"\u200b"==o&&b.find(":last").remove();c=""}"/"==c[1]&&(b=b.parent(),c=h.shift()||"");b.append(c);a.typing(k.parent(),n(),q);!c.match(/<ins>/)&&c.match(/></)&&(b=b.find(":last"));(c=h.shift())?(a.mistype&&c&&!c[1]&&"\u200b"!=b.data().del&&" "!=c&&!~~(Math.random()*a.mistype)&&-1<(__=d.inArray(c.toLowerCase(),m,2))&&(__+=~~(2*
Math.random())+1,~~(2*Math.random())&&(__-=3),h=d.merge([90>c.charCodeAt(0)?m[__].toUpperCase():m[__],"</del>",c],h),c='<del data-ins="0.25" data-del="\u200b"></del>'),c&&"/"==c[1]&&b.data().ins&&(c=~~(1E3*Number(b.data().ins)/a.speed))):(clearInterval(s),k.parent().removeData(["is_typing","pause"]),f(a.repeat)&&--a.repeat,-1<a.repeat?(a.init=d.noop,k.parent().t(f(e,"o")?a:e,a)):a.fin(k.parent()))}},a.speed)}})}})(jQuery);
